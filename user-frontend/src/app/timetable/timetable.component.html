<div class="timetable-container">
    <h2 class="text-center my-3">Festival Timetable</h2>
    
    <div class="flex p-2 rounded-lg space-x-2">
        @for (day of days; track day.id) {
          <div 
            class="px-4 py-2 text-center font-bold border border-black rounded-md cursor-pointer"
            [class.bg-pink-400]="day.active"
            [class.rounded-lg]="day.active"
            (click)="selectDay(day.id)">
              {{ day.label }}<br>
              <span class="font-normal">{{ day.date }}</span>
          </div>
        }
      </div>      
    

    <div class="timetable-header grid" 
         [style.gridTemplateColumns]="'60px repeat(' + stages().length + ', 1fr)'">
      <div></div>
      @for (stage of stages(); track stage) {
        <div class="stage-header text-center border border-gray-300 p-2">
          {{ stage }}
        </div>
      }
    </div>
    
    <div class="timetable-body relative overflow-y-auto h-[600px] border border-gray-300">
        <div class="background-grid grid"
           [style.gridTemplateColumns]="'60px repeat(' + stages().length + ', 1fr)'"
           style="grid-template-rows: repeat(288, 10px);">
            @for (interval of getIntervals(); track interval) {
                @if (interval % 3 === 0) {
                    <div class="time-label border-t border-gray-300 flex items-center justify-end pr-1" 
                    [class.border-t]="interval % 3 !== 0">
                    @if (interval % 12 === 0) {
                        {{ interval / 12 }}:00
                    }
                    </div>
                    @for (stage of stages(); track stage) {
                        <div class="cell border-t border-l border-gray-300"></div>
                    }
                } @else {
                    <div class="time-label flex items-center justify-end pr-1">
                    @if (interval % 12 === 0) {
                        {{ interval / 12 }}:00
                    }
                    </div>
                    @for (stage of stages(); track stage) {
                        <div class="cell border-l border-gray-300"></div>
                    }
                }
            }
        </div>
      
      <div class="events-overlay absolute inset-0 grid"
           [style.gridTemplateColumns]="'60px repeat(' + stages().length + ', 1fr)'"
           style="grid-template-rows: repeat(288, 10px); pointer-events: none;">
        @for (stage of stages(); track stage) {
          @for (act of getActs(stage); track act.name) {
            <div class="event bg-blue-200 border text-xs p-1"
                 [style.gridColumn]="stages().indexOf(stage) + 2"
                 [style.gridRow]="getStartRow(act) + ' / span ' + getRowSpan(act)"
                 style="pointer-events: auto;">
              <strong>{{ act.name }}</strong><br>
              <small>
                {{ act.beginTime.getHours() }}:
                {{ act.beginTime.getMinutes() <= 9 ? '0' + act.beginTime.getMinutes() : act.beginTime.getMinutes() }} -
                {{ act.endTime.getHours() }}:
                {{ act.endTime.getMinutes() <= 9 ? '0' + act.endTime.getMinutes() : act.endTime.getMinutes() }}
              </small>
            </div>
          }
        }
      </div>
    </div>
  </div>
  